(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6821],{5709:function(e,s,t){Promise.resolve().then(t.bind(t,5628))},5628:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return O}});var l=t(7437),a=t(2265),r=t(1396),i=t.n(r),d=t(2749),n=t(4033),c=t(6712),o=t(3008),x=t(4808),m=t(4322),h=t(1961),u=t(6264),p=t(7158),j=t(3067),v=t(2104),N=t(1738),f=t(6142),g=t(2741),y=t(8203),b=t(6637),w=t(5925);let E=[{value:"PENDING",label:"Order Placed",icon:c.Z,description:"Your order has been placed"},{value:"CONFIRMED",label:"Confirmed",icon:o.Z,description:"Order confirmed by seller"},{value:"PROCESSING",label:"Processing",icon:x.Z,description:"Order is being prepared"},{value:"SHIPPED",label:"Shipped",icon:m.Z,description:"Order has been shipped"},{value:"OUT_FOR_DELIVERY",label:"Out for Delivery",icon:h.Z,description:"Order is on the way"},{value:"DELIVERED",label:"Delivered",icon:o.Z,description:"Order delivered successfully"}],D={PENDING:"bg-yellow-500",CONFIRMED:"bg-blue-500",PROCESSING:"bg-blue-500",SHIPPED:"bg-purple-500",OUT_FOR_DELIVERY:"bg-orange-500",DELIVERED:"bg-green-500",CANCELLED:"bg-red-500"};function O(){var e,s,t,r,c,o,x;let{data:h,status:O}=(0,d.useSession)(),S=(0,n.useRouter)(),I=(0,n.useParams)(),Z=null==I?void 0:I.id,[A,C]=(0,a.useState)(null),[P,R]=(0,a.useState)(!0);(0,a.useEffect)(()=>{if("unauthenticated"===O){S.push("/login?callbackUrl=/account/orders");return}"authenticated"===O&&Z&&F()},[O,S,Z]);let F=async()=>{try{R(!0);let e=await fetch("/api/orders/".concat(Z));if(e.ok){let s=await e.json();C(s)}else w.ZP.error("Order not found"),S.push("/account/orders")}catch(e){console.error("Error fetching order:",e),w.ZP.error("Failed to load order")}finally{R(!1)}},z=e=>new Date(e).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});if("loading"===O||P)return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsx)(u.Z,{className:"w-8 h-8 animate-spin text-primary-600"})});if(!A)return null;let L="CANCELLED"===(x=A.status)?-1:E.findIndex(e=>e.value===x),_="CANCELLED"===A.status;return(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)("div",{className:"bg-white border-b",children:(0,l.jsxs)("div",{className:"container-custom py-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-4",children:[(0,l.jsx)(i(),{href:"/",className:"hover:text-primary-600",children:"Home"}),(0,l.jsx)(p.Z,{size:16}),(0,l.jsx)(i(),{href:"/account",className:"hover:text-primary-600",children:"Account"}),(0,l.jsx)(p.Z,{size:16}),(0,l.jsx)(i(),{href:"/account/orders",className:"hover:text-primary-600",children:"Orders"}),(0,l.jsx)(p.Z,{size:16}),(0,l.jsxs)("span",{className:"text-gray-800",children:["#",A.orderNumber||A.id.slice(-8).toUpperCase()]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(i(),{href:"/account/orders",className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,l.jsx)(j.Z,{size:20})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h1",{className:"text-2xl font-bold text-gray-800",children:["Order #",A.orderNumber||A.id.slice(-8).toUpperCase()]}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["Placed on ",z(A.createdAt)]})]})]}),(0,l.jsx)("span",{className:"px-4 py-2 rounded-full text-sm font-medium ".concat(_?"bg-red-100 text-red-700":"DELIVERED"===A.status?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"),children:_?"Cancelled":(null===(e=E.find(e=>e.value===A.status))||void 0===e?void 0:e.label)||A.status})]})]})}),(0,l.jsx)("div",{className:"container-custom py-8",children:(0,l.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-6",children:"Order Timeline"}),_?(0,l.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-red-50 rounded-lg",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,l.jsx)(v.Z,{className:"text-red-600",size:24})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-semibold text-red-700",children:"Order Cancelled"}),(0,l.jsxs)("p",{className:"text-sm text-red-600",children:["This order was cancelled on ",z(A.updatedAt)]})]})]}):(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"absolute left-6 top-6 bottom-6 w-0.5 bg-gray-200"}),(0,l.jsx)("div",{className:"absolute left-6 top-6 w-0.5 ".concat(D[A.status]," transition-all duration-500"),style:{height:"".concat(Math.max(0,L/(E.length-1)*100),"%"),maxHeight:"calc(100% - 48px)"}}),(0,l.jsx)("div",{className:"space-y-6",children:E.map((e,s)=>{var t;let a=L>=s,r=L===s,i=e.icon,d=null===(t=A.statusHistory)||void 0===t?void 0:t.find(s=>s.status===e.value),n="PENDING"===e.value?A.createdAt:"DELIVERED"===e.value&&A.deliveredAt?A.deliveredAt:null==d?void 0:d.timestamp;return(0,l.jsxs)("div",{className:"relative flex items-start gap-4",children:[(0,l.jsx)("div",{className:"\n                            w-12 h-12 rounded-full flex items-center justify-center z-10 transition-all\n                            ".concat(a?"".concat(D[e.value]," text-white"):"bg-gray-100 text-gray-400","\n                            ").concat(r?"ring-4 ring-offset-2 ring-primary-200":"","\n                          "),children:(0,l.jsx)(i,{size:20})}),(0,l.jsxs)("div",{className:"flex-1 pt-1 ".concat(a?"":"opacity-50"),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h3",{className:"font-semibold ".concat(a?"text-gray-800":"text-gray-500"),children:e.label}),n&&a&&(0,l.jsx)("span",{className:"text-xs text-gray-500",children:z(n)})]}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:e.description}),r&&!_&&(0,l.jsx)("span",{className:"inline-block mt-2 px-2 py-0.5 bg-primary-100 text-primary-600 text-xs rounded-full",children:"Current Status"})]})]},e.value)})})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold mb-4",children:["Order Items (",A.items.length,")"]}),(0,l.jsx)("div",{className:"divide-y",children:A.items.map(e=>{var s,t;return(0,l.jsxs)("div",{className:"py-4 flex gap-4",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:(null===(t=e.product.images)||void 0===t?void 0:null===(s=t[0])||void 0===s?void 0:s.url)?(0,l.jsx)("img",{src:e.product.images[0].url,alt:e.product.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,l.jsx)(m.Z,{className:"text-gray-400",size:32})})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)(i(),{href:"/products/".concat(e.product.slug),className:"font-medium text-gray-800 hover:text-primary-600",children:e.product.name}),(0,l.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[e.product.unit," \xd7 ",e.quantity]}),(0,l.jsxs)("p",{className:"font-semibold text-primary-600 mt-1",children:["₹",(e.price*e.quantity).toFixed(2)]})]})]},e.id)})})]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Order Summary"}),(0,l.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Subtotal"}),(0,l.jsxs)("span",{children:["₹",(null===(s=A.subtotal)||void 0===s?void 0:s.toFixed(2))||"0.00"]})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Delivery Fee"}),(0,l.jsx)("span",{children:0===A.deliveryFee?"FREE":"₹".concat(null===(t=A.deliveryFee)||void 0===t?void 0:t.toFixed(2))})]}),A.discount>0&&(0,l.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,l.jsx)("span",{children:"Discount"}),(0,l.jsxs)("span",{children:["-₹",null===(r=A.discount)||void 0===r?void 0:r.toFixed(2)]})]}),A.walletUsed>0&&(0,l.jsxs)("div",{className:"flex justify-between text-blue-600",children:[(0,l.jsx)("span",{children:"Wallet Used"}),(0,l.jsxs)("span",{children:["-₹",null===(c=A.walletUsed)||void 0===c?void 0:c.toFixed(2)]})]}),(0,l.jsxs)("div",{className:"flex justify-between font-semibold text-base pt-3 border-t",children:[(0,l.jsx)("span",{children:"Total"}),(0,l.jsxs)("span",{className:"text-primary-600",children:["₹",null===(o=A.total)||void 0===o?void 0:o.toFixed(2)]})]})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,l.jsx)(N.Z,{size:20}),"Payment"]}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Method"}),(0,l.jsx)("span",{className:"font-medium",children:A.paymentMethod||"N/A"})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Status"}),(0,l.jsx)("span",{className:"font-medium ".concat("PAID"===A.paymentStatus?"text-green-600":"PENDING"===A.paymentStatus?"text-yellow-600":"text-red-600"),children:A.paymentStatus})]})]})]}),A.deliveryAddress&&(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,l.jsx)(f.Z,{size:20}),"Delivery Address"]}),(0,l.jsxs)("div",{className:"text-sm space-y-1",children:[(0,l.jsx)("p",{className:"font-medium",children:A.deliveryAddress.name}),(0,l.jsx)("p",{className:"text-gray-600",children:A.deliveryAddress.street}),(0,l.jsxs)("p",{className:"text-gray-600",children:[A.deliveryAddress.city,", ",A.deliveryAddress.state," - ",A.deliveryAddress.postalCode]}),A.deliveryAddress.phone&&(0,l.jsxs)("p",{className:"text-gray-600 flex items-center gap-1 mt-2",children:[(0,l.jsx)(g.Z,{size:14}),A.deliveryAddress.phone]})]})]}),A.deliverySlot&&(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,l.jsx)(y.Z,{size:20}),"Delivery Slot"]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("p",{className:"font-medium",children:A.deliverySlot.date}),(0,l.jsx)("p",{className:"text-gray-600",children:A.deliverySlot.timeSlot})]})]}),A.notes&&(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,l.jsx)(b.Z,{size:20}),"Order Notes"]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:A.notes})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)(i(),{href:"/account/orders",className:"w-full btn-outline flex items-center justify-center gap-2",children:[(0,l.jsx)(j.Z,{size:18}),"Back to Orders"]}),"DELIVERED"===A.status&&(0,l.jsx)("button",{className:"w-full btn-primary",children:"Reorder Items"})]})]})]})})]})}}},function(e){e.O(0,[6221,2749,4766,2971,4938,1744],function(){return e(e.s=5709)}),_N_E=e.O()}]);