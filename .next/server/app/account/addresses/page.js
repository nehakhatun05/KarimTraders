(()=>{var e={};e.id=2967,e.ids=[2967],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},14021:e=>{"use strict";e.exports=import("next/dist/compiled/@vercel/og/index.node.js")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},26174:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>o,routeModule:()=>x,tree:()=>c});var a=t(50482),r=t(69108),i=t(62563),n=t.n(i),d=t(68300),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);t.d(s,l);let c=["",{children:["account",{children:["addresses",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,33880)),"c:\\Users\\basan\\Desktop\\karim123\\KarimTraders\\src\\app\\account\\addresses\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,61702))).default(e)],apple:[],openGraph:[],twitter:[],manifest:"/manifest.webmanifest"}}]},{layout:[()=>Promise.resolve().then(t.bind(t,22879)),"c:\\Users\\basan\\Desktop\\karim123\\KarimTraders\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,24117)),"c:\\Users\\basan\\Desktop\\karim123\\KarimTraders\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,92793)),"c:\\Users\\basan\\Desktop\\karim123\\KarimTraders\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,48206)),"c:\\Users\\basan\\Desktop\\karim123\\KarimTraders\\src\\app\\not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,61702))).default(e)],apple:[],openGraph:[],twitter:[],manifest:"/manifest.webmanifest"}}],o=["c:\\Users\\basan\\Desktop\\karim123\\KarimTraders\\src\\app\\account\\addresses\\page.tsx"],m="/account/addresses/page",u={require:t,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/account/addresses/page",pathname:"/account/addresses",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},44418:(e,s,t)=>{Promise.resolve().then(t.bind(t,26487))},98026:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(69224).Z)("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]])},26075:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(69224).Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},26487:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var a=t(95344),r=t(3729),i=t(20783),n=t.n(i),d=t(47674),l=t(22254),c=t(72086),o=t(98026),m=t(80508),u=t(42739),x=t(97751),p=t(51838),h=t(14513);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let y=(0,t(69224).Z)("LocateFixed",[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var g=t(26075),b=t(38271),f=t(76755),j=t(44669);function v(){let{data:e,status:s}=(0,d.useSession)(),t=(0,l.useRouter)(),[i,v]=(0,r.useState)([]),[N,k]=(0,r.useState)(!0),[P,w]=(0,r.useState)(!1),[Z,L]=(0,r.useState)(null),[C,A]=(0,r.useState)(!1),[S,D]=(0,r.useState)(!1),[q,_]=(0,r.useState)({type:"HOME",name:"",phone:"",addressLine1:"",addressLine2:"",landmark:"",city:"",state:"",pincode:"",isDefault:!1});(0,r.useEffect)(()=>{if("unauthenticated"===s){t.push("/login?callbackUrl=/account/addresses");return}"authenticated"===s&&z()},[s,t]);let z=async()=>{try{k(!0);let e=await fetch("/api/user/addresses");if(e.ok){let s=await e.json();v(s||[])}}catch(e){console.error("Error fetching addresses:",e),j.ZP.error("Failed to load addresses")}finally{k(!1)}},O=async e=>{e.preventDefault(),A(!0);try{let e=Z?`/api/user/addresses/${Z.id}`:"/api/user/addresses",s=await fetch(e,{method:Z?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)});if(s.ok)j.ZP.success(Z?"Address updated successfully":"Address added successfully"),z(),T();else{let e=await s.json();j.ZP.error(e.error||"Failed to save address")}}catch(e){j.ZP.error("Something went wrong")}finally{A(!1)}},T=()=>{w(!1),L(null),D(!1),_({type:"HOME",name:"",phone:"",addressLine1:"",addressLine2:"",landmark:"",city:"",state:"",pincode:"",isDefault:!1})},E=async()=>{if(!navigator.geolocation){j.ZP.error("Geolocation is not supported by your browser");return}D(!0);try{let{latitude:e,longitude:s}=(await new Promise((e,s)=>{navigator.geolocation.getCurrentPosition(e,s,{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})})).coords,t=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${s}&addressdetails=1`,{headers:{"Accept-Language":"en"}}),a=await t.json();if(a&&a.address){let e=a.address,s=[];e.house_number&&s.push(e.house_number),e.road&&s.push(e.road);let t=e.suburb||e.neighbourhood||e.village||"";_(a=>({...a,addressLine1:s.join(", ")||t||"Near current location",addressLine2:t&&s.length>0?t:"",city:e.city||e.town||e.village||e.state_district||"",state:e.state||"",pincode:e.postcode||""})),j.ZP.success("Location detected! Please verify and complete the address.")}else j.ZP.error("Could not get address details. Please enter manually.")}catch(e){console.error("Location detection error:",e),1===e.code?j.ZP.error("Location access denied. Please enable location permissions."):2===e.code?j.ZP.error("Location unavailable. Please try again."):3===e.code?j.ZP.error("Location request timed out. Please try again."):j.ZP.error("Failed to detect location. Please enter address manually.")}finally{D(!1)}},M=async e=>{if(_(s=>({...s,pincode:e})),6===e.length)try{let s=await fetch(`https://api.postalpincode.in/pincode/${e}`),t=await s.json();if(t[0]?.Status==="Success"&&t[0]?.PostOffice?.length>0){let e=t[0].PostOffice[0];_(s=>({...s,city:s.city||e.District,state:s.state||e.State,addressLine2:s.addressLine2||e.Name}))}}catch(e){console.error("Pincode lookup failed:",e)}},U=e=>{L(e),_(e),w(!0)},F=async e=>{if(confirm("Are you sure you want to delete this address?"))try{(await fetch(`/api/user/addresses/${e}`,{method:"DELETE"})).ok?(j.ZP.success("Address deleted"),z()):j.ZP.error("Failed to delete address")}catch(e){j.ZP.error("Something went wrong")}},$=async e=>{try{(await fetch(`/api/user/addresses/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isDefault:!0})})).ok?(j.ZP.success("Default address updated"),z()):j.ZP.error("Failed to update default address")}catch(e){j.ZP.error("Something went wrong")}},H=e=>{switch(e){case"HOME":return c.Z;case"WORK":return o.Z;default:return m.Z}};return"loading"===s||N?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsx(u.Z,{className:"w-8 h-8 animate-spin text-primary-600"})}):"unauthenticated"===s?null:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white border-b",children:(0,a.jsxs)("div",{className:"container-custom py-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-4",children:[a.jsx(n(),{href:"/",className:"hover:text-primary-600",children:"Home"}),a.jsx(x.Z,{size:16}),a.jsx(n(),{href:"/account",className:"hover:text-primary-600",children:"Account"}),a.jsx(x.Z,{size:16}),a.jsx("span",{className:"text-gray-800",children:"My Addresses"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"My Addresses"}),(0,a.jsxs)("button",{onClick:()=>w(!0),className:"btn-primary flex items-center gap-2",children:[a.jsx(p.Z,{size:18}),"Add Address"]})]})]})}),(0,a.jsxs)("div",{className:"container-custom py-8",children:[P&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"p-6 border-b flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-bold",children:Z?"Edit Address":"Add New Address"}),a.jsx("button",{onClick:T,className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(h.Z,{size:20})})]}),(0,a.jsxs)("form",{onSubmit:O,className:"p-6 space-y-4",children:[!Z&&a.jsx("button",{type:"button",onClick:E,disabled:S,className:"w-full flex items-center justify-center gap-2 py-3 border-2 border-dashed border-primary-300 bg-primary-50 hover:bg-primary-100 rounded-xl text-primary-700 font-medium transition-colors disabled:opacity-50",children:S?(0,a.jsxs)(a.Fragment,{children:[a.jsx(u.Z,{size:20,className:"animate-spin"}),"Detecting location..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(y,{size:20}),"Use Current Location"]})}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address Type"}),a.jsx("div",{className:"flex gap-3",children:[{value:"HOME",label:"Home"},{value:"WORK",label:"Work"},{value:"OTHER",label:"Other"}].map(({value:e,label:s})=>{let t=H(e);return(0,a.jsxs)("button",{type:"button",onClick:()=>_({...q,type:e}),className:`flex items-center gap-2 px-4 py-2 rounded-lg border ${q.type===e?"border-primary-600 bg-primary-50 text-primary-600":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx(t,{size:18}),s]},e)})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),a.jsx("input",{type:"text",value:q.name,onChange:e=>_({...q,name:e.target.value}),className:"input",required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),a.jsx("input",{type:"tel",value:q.phone,onChange:e=>_({...q,phone:e.target.value}),className:"input",required:!0})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address Line 1"}),a.jsx("textarea",{value:q.addressLine1,onChange:e=>_({...q,addressLine1:e.target.value}),className:"input",rows:2,placeholder:"House/Flat No., Building, Street",required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address Line 2 (Optional)"}),a.jsx("input",{type:"text",value:q.addressLine2||"",onChange:e=>_({...q,addressLine2:e.target.value}),className:"input",placeholder:"Area, Colony, Sector"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Landmark (Optional)"}),a.jsx("input",{type:"text",value:q.landmark||"",onChange:e=>_({...q,landmark:e.target.value}),className:"input",placeholder:"Near..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),a.jsx("input",{type:"text",value:q.city,onChange:e=>_({...q,city:e.target.value}),className:"input",required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),a.jsx("input",{type:"text",value:q.state,onChange:e=>_({...q,state:e.target.value}),className:"input",required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pincode"}),a.jsx("input",{type:"text",value:q.pincode,onChange:e=>M(e.target.value.replace(/\D/g,"").slice(0,6)),className:"input",maxLength:6,pattern:"\\d{6}",required:!0})]})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:q.isDefault,onChange:e=>_({...q,isDefault:e.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Set as default address"})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:T,className:"flex-1 btn-outline",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:C,className:"flex-1 btn-primary disabled:opacity-50",children:C?"Saving...":Z?"Update Address":"Save Address"})]})]})]})}),i.length>0?a.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:i.map(e=>{let s=H(e.type);return(0,a.jsxs)("div",{className:`bg-white rounded-xl shadow-sm p-6 border-2 ${e.isDefault?"border-primary-500":"border-transparent"}`,children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"p-2 bg-gray-100 rounded-lg",children:a.jsx(s,{size:20,className:"text-gray-600"})}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-semibold text-gray-800 capitalize",children:e.type.toLowerCase()}),e.isDefault&&a.jsx("span",{className:"ml-2 px-2 py-0.5 bg-primary-100 text-primary-600 text-xs rounded-full",children:"Default"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>U(e),className:"p-2 hover:bg-gray-100 rounded-lg text-gray-500 hover:text-primary-600",children:a.jsx(g.Z,{size:18})}),a.jsx("button",{onClick:()=>F(e.id),className:"p-2 hover:bg-gray-100 rounded-lg text-gray-500 hover:text-red-600",children:a.jsx(b.Z,{size:18})})]})]}),(0,a.jsxs)("div",{className:"space-y-2 text-gray-600",children:[a.jsx("p",{className:"font-medium text-gray-800",children:e.name}),a.jsx("p",{children:e.addressLine1}),e.addressLine2&&a.jsx("p",{children:e.addressLine2}),e.landmark&&(0,a.jsxs)("p",{className:"text-sm",children:["Near: ",e.landmark]}),(0,a.jsxs)("p",{children:[e.city,", ",e.state," - ",e.pincode]}),a.jsx("p",{className:"text-primary-600",children:e.phone})]}),!e.isDefault&&(0,a.jsxs)("button",{onClick:()=>$(e.id),className:"mt-4 flex items-center gap-1 text-sm text-primary-600 hover:text-primary-700",children:[a.jsx(f.Z,{size:16}),"Set as Default"]})]},e.id)})}):(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[a.jsx(m.Z,{size:64,className:"mx-auto text-gray-300 mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No addresses saved"}),a.jsx("p",{className:"text-gray-500 mb-6",children:"Add your delivery addresses for faster checkout"}),a.jsx("button",{onClick:()=>w(!0),className:"btn-primary",children:"Add Your First Address"})]})]})]})}},33880:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>r,default:()=>n});let a=(0,t(86843).createProxy)(String.raw`c:\Users\basan\Desktop\karim123\KarimTraders\src\app\account\addresses\page.tsx`),{__esModule:r,$$typeof:i}=a,n=a.default}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[1638,7861,4150],()=>t(26174));module.exports=a})();