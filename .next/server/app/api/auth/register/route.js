"use strict";(()=>{var e={};e.id=3002,e.ids=[3002],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},83703:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>f,originalPathname:()=>b,patchFetch:()=>v,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>w,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>y});var a={};t.r(a),t.d(a,{POST:()=>d});var s=t(95419),i=t(69108),o=t(99678),n=t(78070),u=t(7529),l=t(34490),c=t(82196);let p=c.z.object({name:c.z.string().min(2,"Name must be at least 2 characters"),email:c.z.string().email("Invalid email address"),phone:c.z.string().optional(),password:c.z.string().min(8,"Password must be at least 8 characters")});async function d(e){try{let r=await e.json(),t=p.parse(r);if(await l.Z.user.findFirst({where:{OR:[{email:t.email},...t.phone?[{phone:t.phone}]:[]]}}))return n.Z.json({error:"User already exists with this email or phone"},{status:400});let a=await u.ZP.hash(t.password,12),s=await l.Z.user.create({data:{name:t.name,email:t.email,phone:t.phone,password:a},select:{id:!0,name:!0,email:!0,phone:!0,createdAt:!0}});return await l.Z.wallet.create({data:{userId:s.id,balance:100,transactions:{create:{type:"BONUS",amount:100,description:"Welcome bonus"}}}}),await l.Z.notification.create({data:{userId:s.id,type:"SYSTEM",title:"Welcome to KARIM TRADERS!",message:"Your account has been created successfully. Enjoy â‚¹100 welcome bonus in your wallet!"}}),n.Z.json({message:"User created successfully",user:s},{status:201})}catch(e){if(e instanceof c.z.ZodError)return n.Z.json({error:e.errors[0].message},{status:400});return console.error("Registration error:",e),n.Z.json({error:"Internal server error"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"C:\\Users\\basan\\Desktop\\karim123\\KarimTraders\\src\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:g,serverHooks:w,headerHooks:f,staticGenerationBailout:y}=m,b="/api/auth/register/route";function v(){return(0,o.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:g})}},34490:(e,r,t)=>{t.d(r,{Z:()=>i,_:()=>s});var a=t(53524);let s=globalThis.prisma??new a.PrismaClient({log:["error"]}),i=s}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[1638,6206,7529,2196],()=>t(83703));module.exports=a})();