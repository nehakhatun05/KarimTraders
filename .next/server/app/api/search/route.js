"use strict";(()=>{var e={};e.id=280,e.ids=[280],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1145:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>m,originalPathname:()=>y,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>p,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>h});var r={};a.r(r),a.d(r,{GET:()=>u});var s=a(95419),i=a(69108),n=a(99678),o=a(78070),c=a(34490);async function u(e){try{let{searchParams:t}=new URL(e.url),a=t.get("q"),r=parseInt(t.get("limit")||"10");if(!a||a.length<2)return o.Z.json({products:[],categories:[],suggestions:[]});let s=await c.Z.product.findMany({where:{isActive:!0,OR:[{name:{contains:a,mode:"insensitive"}},{description:{contains:a,mode:"insensitive"}},{tags:{has:a.toLowerCase()}},{category:{name:{contains:a,mode:"insensitive"}}}]},include:{images:{take:1},category:{select:{name:!0,slug:!0}}},take:r,orderBy:[{featured:"desc"},{rating:"desc"}]}),i=await c.Z.category.findMany({where:{name:{contains:a,mode:"insensitive"}},select:{id:!0,name:!0,slug:!0,image:!0,_count:{select:{products:!0}}},take:5}),n=[...i.map(e=>({type:"category",name:e.name,slug:e.slug})),...s.slice(0,5).map(e=>({type:"product",name:e.name,slug:e.slug}))],u=s.map(e=>({id:e.id,name:e.name,slug:e.slug,price:e.price,originalPrice:e.originalPrice,discount:e.discount,image:e.images[0]?.url||null,category:e.category?.name||null,categorySlug:e.category?.slug||null,stockStatus:e.stockStatus})),l=i.map(e=>({id:e.id,name:e.name,slug:e.slug,image:e.image,productCount:e._count.products}));return o.Z.json({products:u,categories:l,suggestions:n,total:s.length})}catch(e){return console.error("Search error:",e),o.Z.json({error:"Search failed"},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/search/route",pathname:"/api/search",filename:"route",bundlePath:"app/api/search/route"},resolvedPagePath:"C:\\Users\\basan\\Desktop\\karim123\\KarimTraders\\src\\app\\api\\search\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:d,staticGenerationAsyncStorage:g,serverHooks:p,headerHooks:m,staticGenerationBailout:h}=l,y="/api/search/route";function v(){return(0,n.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:g})}},34490:(e,t,a)=>{a.d(t,{Z:()=>i,_:()=>s});var r=a(53524);let s=globalThis.prisma??new r.PrismaClient({log:["error"]}),i=s}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[1638,6206],()=>a(1145));module.exports=r})();